# í´ëŸ¬ìŠ¤í„° ì„œë²„ì—ì„œ EC2 ì„œë²„ mysql ì ‘ê·¼

ë¶„ë¥˜: Server
ìƒì„±ì¼: 2022ë…„ 9ì›” 24ì¼ ì˜¤í›„ 9:12
ì‘ì„±ì: ì°½ëª¨ ì—°
íƒœê·¸: Docker, MySQL

ê¸°ì¡´ docker-compose.yml íŒŒì¼ì— db ì„¤ì •ì„ image: mysql ë¡œ í–ˆì—ˆë‹¤.

ğŸ’£ **ìº¡ì³ëŠ” ë³€ê²½ëœ ë‚´ìš©ì…ë‹ˆë‹¤.**

![Untitled](%E1%84%8F%E1%85%B3%E1%86%AF%E1%84%85%E1%85%A5%E1%84%89%E1%85%B3%E1%84%90%E1%85%A5%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5%E1%84%8B%E1%85%A6%E1%84%89%E1%85%A5%20EC2%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5%20mysql%20%E1%84%8C%E1%85%A5%E1%86%B8%E1%84%80%E1%85%B3%E1%86%AB%202181f506997f4eee9095de0f43e219e6/Untitled.png)

ê·¸ë¬ë”ë‹ˆ DB ì™¸ë¶€ ì‚¬ìš©ì„ ìœ„í•œ íŒŒì¼ ìˆ˜ì •ì— ë¬¸ì œê°€ ìƒê²¼ë‹¤.

mysql ì»¨í…Œì´ë„ˆë¡œ ë“¤ì–´ê°„ ë’¤ my.cnf íŒŒì¼ì„ ì°¾ì•„ ìˆ˜ì •í•˜ë ¤í–ˆì§€ë§Œ

ë¦¬ëˆ…ìŠ¤ ê¸°ë³¸ ëª…ë ¹ì–´ì¸ vi, vim, nano, apt, apt-get ë“±ì´ command not found ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤. 

```jsx
1. mysql ì»¨í…Œì´ë„ˆ id í™•ì¸ì„ ìœ„í•´ í˜„ì¬ ëŒì•„ê°€ê³  ìˆëŠ” ì»¨í…Œì´ë„ˆë¥¼ í™•ì¸í•˜ê¸° ìœ„í•œ ëª…ë ¹ì–´
sudo docker ps

2. mysql ì»¨í…Œì´ë„ˆ ì•ˆìœ¼ë¡œ ë“¤ì–´ê°€ëŠ” ëª…ë ¹ì–´
sudo docker exec -it [mysqlì»¨í…Œì´ë„ˆid] /bin/bash

3. my.cnf íŒŒì¼ ìˆ˜ì •ì„ ìœ„í•œ íŒŒì¼ ì—´ê¸° ëª…ë ¹ì–´
vi my.cnf # command not found (vi)
vim my.cnf # command not found (vim)
nano my.cnf # command not found (nano)

4. vim ëª…ë ¹ì–´ ë‹¤ìš´ì„ ìœ„í•œ apt-get install ì‚¬ìš©
apt-get install vim # command not found (apt-get)
apt-get install vi # command not found (apt-get)

// mysql ê¸°ì¤€
cd etc
vim my.cnf

// mysql:8.0.30:debian ê¸°ì¤€
cd etc/mysql
vim my.cnf
```

ê²€ìƒ‰í•´ë³´ë‹ˆ

docker-compose.yml íŒŒì¼ì— db ì´ë¯¸ì§€ë¥¼ mysqlë¡œ ì„¤ì •í•˜ë©´ ê¸°ë³¸ ëª…ë ¹ì–´ë¥¼ ì œê³µí•˜ì§€ ì•ŠëŠ”ë‹¨ë‹¤.

ê¸°ë³¸ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„  debian ë²„ì „ì„ ì„¤ì¹˜í•´ì•¼í•œë‹¤.

ë³¸ì¸ì´ ì‚¬ìš©í•˜ê³ ì í•˜ëŠ” ì»¨í…Œì´ë„ˆì˜ ë²„ì „ì„ ì°¾ì•„ë³´ê¸° ìœ„í•´ docker hub ì— ì§ì ‘ ë“¤ì–´ê°€ë³´ëŠ”ê±¸ ê¶Œì¥í•œë‹¤.

[ë„ì»¤í—ˆë¸ŒMysql](https://hub.docker.com/_/mysql)

[mysql - Official Image | Docker Hub](https://hub.docker.com/_/mysql)

2022ë…„ 9ì›” 24ì¼ ê¸°ì¤€ ì œê³µí•˜ëŠ” ë²„ì „

![Untitled](%E1%84%8F%E1%85%B3%E1%86%AF%E1%84%85%E1%85%A5%E1%84%89%E1%85%B3%E1%84%90%E1%85%A5%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5%E1%84%8B%E1%85%A6%E1%84%89%E1%85%A5%20EC2%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5%20mysql%20%E1%84%8C%E1%85%A5%E1%86%B8%E1%84%80%E1%85%B3%E1%86%AB%202181f506997f4eee9095de0f43e219e6/Untitled%201.png)

ì›í•˜ëŠ” ë²„ì „ì„ í™•ì¸í•œ í›„ EC2 ì„œë²„ì˜ docker-compose.yml íŒŒì¼ì„ ìˆ˜ì •í•œë‹¤. (ì‘ì„±ì ê¸°ì¤€)

![Untitled](%E1%84%8F%E1%85%B3%E1%86%AF%E1%84%85%E1%85%A5%E1%84%89%E1%85%B3%E1%84%90%E1%85%A5%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5%E1%84%8B%E1%85%A6%E1%84%89%E1%85%A5%20EC2%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5%20mysql%20%E1%84%8C%E1%85%A5%E1%86%B8%E1%84%80%E1%85%B3%E1%86%AB%202181f506997f4eee9095de0f43e219e6/Untitled.png)

```jsx
1. ë„ì»¤ ì»´í¬ì¦ˆ íŒŒì¼ ì‘ì„±ì„ ë§ˆì¹˜ê³  ì‹¤í–‰ 
( -d ëŠ” ì˜µì…˜, ë°ëª¬, ì‹¤í–‰ë˜ëŠ” ê²ƒì´ ì•ˆë‚˜ì˜´, ë‚˜ì˜¤ê¸¸ ì›í•œë‹¤ë©´ ë¹¼ë„ ë¨)
sudo docker-compose up -d

2. ë„ì»¤ ì»´í¬ì¦ˆ íŒŒì¼ ì•ˆì— ì‘ì„±ëœ ì»¨í…Œì´ë„ˆë“¤ì´ ëŒì•„ê°€ëŠ”ì§€ í™•ì¸í•˜ëŠ” ëª…ë ¹ì–´
sudo docker-compose ls
```

docker-compose ì‚¬ìš©ì„ ìœ„í•œ yml, yaml íŒŒì¼ì„ ì‘ì„±í•˜ì§€ ì•Šê³  ì§ì ‘ ë„ì»¤ ì»¨í…Œì´ë„ˆë¥¼ pull ë°›ê³  run ì‹œì¼œë„ ëœë‹¤.

```jsx
1. ì›í•˜ëŠ” ë²„ì „ì„ ë‹¤ìš´ë°›ëŠ”ë‹¤.
sudo docker pull mysql # ìµœì‹  ë²„ì „ì„ ë‹¤ìš´ë¡œë“œ
sudo docker pull mysql:8.0.30:debian # ë²„ì „ ì§€ì •

2. ë‹¤ìš´ ë°›ì€ ë„ì»¤ ì´ë¯¸ì§€ í™•ì¸
sudo docker images

3. ë„ì»¤ ì»¨í…Œì´ë„ˆ ìƒì„± ë° ì‹¤í–‰ ( ì—¬ëŸ¬ ë°©ë²•ì´ ìˆë‹¤. ê²€ìƒ‰í•´ì„œ ì‚¬ìš©í•˜ê¸¸ ê¶Œì¥í•œë‹¤.)
sudo docker run --name mysql-container -e MYSQL_ROOT_PASSWORD=<password> -d -p 3306:3306 mysql:latest
docker run : ë„ì»¤ ì»¨í…Œì´ë„ˆ ìƒì„± ë° ì‹¤í–‰ ëª…ë ¹ì–´
docker run ì€ í•˜ìœ„ 2ê°œì˜ ëª…ë ¹ì–´ë¥¼ í•©ì¹œ ê²ƒ
docker create : ë„ì»¤ ì»¨í…Œì´ë„ˆ ìƒì„±
docker start : ë„ì»¤ ì»¨í…Œì´ë„ˆ ì‹¤í–‰

--name mysql-container : ì»¨í…Œì´ë„ˆ ì´ë¦„ ì§€ì • mysql-container ëŒ€ì‹  ì›í•˜ëŠ” ì´ë¦„ ì…ë ¥
-e MYSQL_ROOT_PASSWORD=<password> : ROOT ê³„ì • ë¹„ë°€ë²ˆí˜¸ ì§€ì •
-d : ë°ëª¬ ì‹¤í–‰ ( ì‹¤í–‰ë˜ëŠ” ê²ƒì´ í™”ë©´ì— ì•ˆë‚˜ì˜¨ë‹¤. ì—ëŸ¬ë– ì„œ ì‹¤í–‰ ì•ˆë¼ë„ ëª¨ë¥¸ë‹¤. ë¹¼ë„ ëœë‹¤.)
-p 3306:3306 : í¬íŠ¸ í¬ì›Œë”© ( ì™¸ë¶€ì ‘ê·¼ í¬íŠ¸ : ë‚´ë¶€ì ‘ê·¼ í¬íŠ¸ ì§€ì •)

4. ë™ì‘ í™•ì¸
sudo docker ps -a

-a : ì˜µì…˜, ìƒì„±ëœ ì»¨í…Œì´ë„ˆ ì¤‘ ì§€ê¸ˆ ì•ˆëŒì•„ê°€ëŠ” ê²ƒë„ ë‹¤ë‚˜ì˜¨ë‹¤. ( ë¹¼ë„ ë¨)

```

mysql ì»¨í…Œì´ë„ˆë¥¼ ë‹¤ì‹œ ì„¤ì¹˜ í›„, mysql ì»¨í…Œì´ë„ˆ ë‚´ë¶€ë¡œ ë“¤ì–´ê°€ my.cnf íŒŒì¼ì„ ìˆ˜ì •í•œë‹¤.

```jsx
1. mysql ì»¨í…Œì´ë„ˆ id í™•ì¸ì„ ìœ„í•´ í˜„ì¬ ëŒì•„ê°€ê³  ìˆëŠ” ì»¨í…Œì´ë„ˆë¥¼ í™•ì¸í•˜ê¸° ìœ„í•œ ëª…ë ¹ì–´
sudo docker ps

2. mysql ì»¨í…Œì´ë„ˆ ì•ˆìœ¼ë¡œ ë“¤ì–´ê°€ëŠ” ëª…ë ¹ì–´
sudo docker exec -it [mysqlì»¨í…Œì´ë„ˆid] /bin/bash

3. vim ëª…ë ¹ì–´ ë‹¤ìš´ì„ ìœ„í•œ apt-get install ì‚¬ìš©
apt-get install vim # ì´ì   apt-get ëª…ë ¹ì–´ ëŒì•„ê°”ë‹¤.
apt-get install vi

4. my.cnf íŒŒì¼ ìˆ˜ì •ì„ ìœ„í•œ íŒŒì¼ ì—´ê¸° ëª…ë ¹ì–´
vi my.cnf 
vim my.cnf 

// mysql ê¸°ì¤€ ( ì‘ì„±ì ê¸°ì¤€)
cd etc
vim my.cnf

// mysql:8.0.30:debian ê¸°ì¤€ (ì‘ì„±ì ê¸°ì¤€)
cd etc/mysql
vim my.cnf

my.cnf íŒŒì¼ì˜ secure-file-priv ê°’ ìˆ˜ì •
ê¸°ì¡´
secure-file-priv = "íŒŒì¼ ê²½ë¡œ"
ë˜ëŠ”
secure-file-priv = NULL
ì„
secure-file-priv = ""
ë¡œ ë³€ê²½í•œë‹¤.
```

![Untitled](%E1%84%8F%E1%85%B3%E1%86%AF%E1%84%85%E1%85%A5%E1%84%89%E1%85%B3%E1%84%90%E1%85%A5%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5%E1%84%8B%E1%85%A6%E1%84%89%E1%85%A5%20EC2%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5%20mysql%20%E1%84%8C%E1%85%A5%E1%86%B8%E1%84%80%E1%85%B3%E1%86%AB%202181f506997f4eee9095de0f43e219e6/Untitled%202.png)

ë³€ê²½ í›„ í•´ë‹¹ ì»¨í…Œì´ë„ˆë¥¼ ë‹¤ì‹œ ì‹¤í–‰ì‹œì¼œì•¼ ì ìš©ì´ ëœë‹¤.

```jsx
ì»¨í…Œì´ë„ˆë¥¼ ë¹ ì ¸ë‚˜ê°€ëŠ” ë°©ë²•
exit

ì»¨í…Œì´ë„ˆë¥¼ ë¹ ì ¸ë‚˜ì™€ ë‹¤ì‹œ ec2 ì„œë²„ë¡œ ì™€ì„œ ë‹¤ì‹œ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰ ì‹œì¼œì¤€ë‹¤.
ì‘ì„±ì ê¸°ì¤€ docker-compose ì¬ì‹¤í–‰
sudo docker-compose up -d

ì»¨í…Œì´ë„ˆ ì¬ì‹¤í–‰ ( ì´ê±´ ì•ˆí•´ë´ì„œ ë˜ëŠ”ì§€ ì˜ ëª¨ë¥´ê² ë‹¤.)
sudo docker ps
sudo docker restart [mysql ì»¨í…Œì´ë„ˆ ì´ë¦„]

ì´í›„ ì˜ ì ìš©ëëŠ”ì§€ í™•ì¸
1. mysql ì»¨í…Œì´ë„ˆ ì•ˆìœ¼ë¡œ ë“¤ì–´ê°€ëŠ” ëª…ë ¹ì–´
sudo docker exec -it [mysqlì»¨í…Œì´ë„ˆid] /bin/bash

2. vim ëª…ë ¹ì–´ ë‹¤ìš´ì„ ìœ„í•œ apt-get install ì‚¬ìš©
apt-get install vim # ì´ì   apt-get ëª…ë ¹ì–´ ëŒì•„ê°”ë‹¤.
apt-get install vi

3. my.cnf íŒŒì¼ ìˆ˜ì •ì„ ìœ„í•œ íŒŒì¼ ì—´ê¸° ëª…ë ¹ì–´
vi my.cnf 
vim my.cnf 

// mysql ê¸°ì¤€ ( ì‘ì„±ì ê¸°ì¤€)
cd etc
vim my.cnf

mysql ì‹¤í–‰ìœ¼ë¡œ í™•ì¸
mysql ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ

mysql -uroot -p
ë¹„ë°€ë²ˆí˜¸ ì…ë ¥

mysql ì´ ì‹¤í–‰ë˜ë©´
SHOW VARIABLES LIKE "secure_file_priv"; 

value ê°€ ë¹„ì–´ìˆëŠ” ê²ƒì„ í™•ì¸í•˜ë©´ ì„±ê³µ
```

![Untitled](%E1%84%8F%E1%85%B3%E1%86%AF%E1%84%85%E1%85%A5%E1%84%89%E1%85%B3%E1%84%90%E1%85%A5%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5%E1%84%8B%E1%85%A6%E1%84%89%E1%85%A5%20EC2%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%A5%20mysql%20%E1%84%8C%E1%85%A5%E1%86%B8%E1%84%80%E1%85%B3%E1%86%AB%202181f506997f4eee9095de0f43e219e6/Untitled%203.png)